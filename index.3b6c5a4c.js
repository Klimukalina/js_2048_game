!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,s=Array(e);r<e;r++)s[r]=t[r];return s}function e(e,r){if(e){if("string"==typeof e)return t(e,r);var s=Object.prototype.toString.call(e).slice(8,-1);if("Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return t(e,r)}}function r(r){return function(e){if(Array.isArray(e))return t(e)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||e(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s,a,n=function(){var t;function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),this.status=s.STATUS.IDLE,this.initialState=t,this.score=0,this.state=t.map(function(t){return r(t)})}return t=[{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status=s.STATUS.PLAYING,this.state=this.initialState.map(function(t){return r(t)}),this.addNewNumber(),this.addNewNumber()}},{key:"restart",value:function(){this.status=s.STATUS.IDLE,this.state=this.initialState.map(function(t){return r(t)}),this.score=0}},{key:"addNewNumber",value:function(){var t=this.getEmptyPositions();if(0!==t.length){var r,s=Math.floor(Math.random()*t.length),a=function(t){if(Array.isArray(t))return t}(r=t[s])||function(t,e){var r,s,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var n=[],i=!0,o=!1;try{for(a=a.call(t);!(i=(r=a.next()).done)&&(n.push(r.value),2!==n.length);i=!0);}catch(t){o=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw s}}return n}}(r,2)||e(r,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=a[0],i=a[1];this.state[n][i]=.9>Math.random()?2:4}}},{key:"getEmptyPositions",value:function(){for(var t=[],e=0;e<4;e++)for(var r=0;r<4;r++)0===this.state[e][r]&&t.push([e,r]);return t}},{key:"toWin",value:function(){return this.state.some(function(t){return t.includes(2048)})}},{key:"toLose",value:function(){for(var t=0;t<this.state.length;t++)for(var e=0;e<this.state[t].length;e++)if(0===this.state[t][e]||t>0&&this.state[t][e]===this.state[t-1][e]||t<this.state.length-1&&this.state[t][e]===this.state[t+1][e]||e>0&&this.state[t][e]===this.state[t][e-1]||e<this.state[t].length-1&&this.state[t][e]===this.state[t][e+1])return!1;return!0}},{key:"handleMove",value:function(t){t&&this.addNewNumber(),this.toWin()?this.status=s.STATUS.WIN:this.toLose()&&(this.status=s.STATUS.LOSE)}},{key:"moveLeft",value:function(){if(this.status===s.STATUS.PLAYING){for(var t=this.state.length,e=!1,r=0;r<t;r++){for(var a=[],n=Array(t).fill(!1),i=0;i<t;i++)0!==this.state[r][i]&&a.push(this.state[r][i]);for(var o=0;o<a.length-1;o++)a[o]!==a[o+1]||n[o]||n[o+1]||(a[o]*=2,this.score+=a[o],a.splice(o+1,1),n[o]=!0);for(;a.length<t;)a.push(0);for(var l=0;l<t;l++)this.state[r][l]!==a[l]&&(this.state[r][l]=a[l],e=!0)}this.handleMove(e)}}},{key:"moveRight",value:function(){if(this.status===s.STATUS.PLAYING){for(var t=this.state.length,e=!1,r=0;r<t;r++){for(var a=[],n=Array(t).fill(!1),i=0;i<t;i++)0!==this.state[r][i]&&a.push(this.state[r][i]);for(var o=a.length-1;o>0;o--)a[o]!==a[o-1]||n[o]||n[o-1]||(a[o]*=2,this.score+=a[o],a.splice(o-1,1),n[o]=!0);for(;a.length<t;)a.unshift(0);for(var l=0;l<t;l++)this.state[r][l]!==a[l]&&(this.state[r][l]=a[l],e=!0)}this.handleMove(e)}}},{key:"moveUp",value:function(){if(this.getStatus()===s.STATUS.PLAYING){for(var t=this.state.length,e=!1,r=0;r<t;r++){for(var a=[],n=0;n<t;n++)0!==this.state[n][r]&&a.push(this.state[n][r]);for(var i=0;i<a.length-1;i++)a[i]===a[i+1]&&(a[i]*=2,this.score+=a[i],a.splice(i+1,1));for(;a.length<t;)a.push(0);for(var o=0;o<t;o++)this.state[o][r]!==a[o]&&(this.state[o][r]=a[o],e=!0)}this.handleMove(e)}}},{key:"moveDown",value:function(){if(this.getStatus()===s.STATUS.PLAYING){for(var t=this.state.length,e=!1,r=0;r<t;r++){for(var a=[],n=0;n<t;n++)0!==this.state[n][r]&&a.push(this.state[n][r]);for(var i=Array(a.length).fill(!1),o=a.length-1;o>0;o--)a[o]!==a[o-1]||i[o]||i[o-1]||(a[o]*=2,this.score+=a[o],a.splice(o-1,1),i[o]=!0);for(;a.length<t;)a.unshift(0);for(var l=0;l<t;l++)this.state[l][r]!==a[l]&&(this.state[l][r]=a[l],e=!0)}this.handleMove(e)}}}],function(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}(s.prototype,t),s}();a={IDLE:"idle",PLAYING:"playing",WIN:"win",LOSE:"lose"},(s="STATUS")in n?Object.defineProperty(n,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[s]=a;var i=new n,o={startButton:document.querySelector(".start"),gameScore:document.querySelector(".game-score"),gameBoardRows:document.querySelectorAll("tr"),messageLose:document.querySelector(".message-lose"),messageWin:document.querySelector(".message-win"),messageStart:document.querySelector(".message-start")},l=o.startButton,u=o.gameScore,h=o.gameBoardRows,c=o.messageLose,f=o.messageWin,v=o.messageStart,d=function(){var t=i.getState();h.forEach(function(e,r){var s=!0,a=!1,n=void 0;try{for(var i,o=e.cells[Symbol.iterator]();!(s=(i=o.next()).done);s=!0){var l=i.value;l.textContent="",l.className="field-cell";var u=l.cellIndex,h=t[r][u];0!==h&&(l.textContent=h,l.classList.add("".concat(l.className,"--").concat(h)))}}catch(t){a=!0,n=t}finally{try{s||null==o.return||o.return()}finally{if(a)throw n}}})},m=function(){c.classList.add("hidden"),f.classList.add("hidden"),v.classList.add("hidden"),"win"===i.getStatus()?f.classList.remove("hidden"):"lose"===i.getStatus()?c.classList.remove("hidden"):"idle"===i.getStatus()&&v.classList.remove("hidden")},y=function(){u.textContent=i.getScore()},g=!0;l.addEventListener("click",function(){"Start"===l.textContent&&i.start(),"Restart"===l.textContent&&(i.restart(),l.textContent="Start",l.classList.remove("restart"),l.classList.add("start"),y()),d(),m(),g=!0}),document.addEventListener("keydown",function(t){if("idle"!==i.getStatus()){switch(t.key){case"ArrowLeft":i.moveLeft();break;case"ArrowRight":i.moveRight();break;case"ArrowUp":i.moveUp();break;case"ArrowDown":i.moveDown()}g&&(l.textContent="Restart",l.classList.remove("start"),l.classList.add("restart"),g=!1),m(),d(),y()}})}();
//# sourceMappingURL=index.3b6c5a4c.js.map
